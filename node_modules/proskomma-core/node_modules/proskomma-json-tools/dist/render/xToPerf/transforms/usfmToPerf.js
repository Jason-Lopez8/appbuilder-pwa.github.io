"use strict";

var usfmToPerfCode = function usfmToPerfCode(_ref) {
  var {
    usfm,
    selectors,
    proskomma
  } = _ref;
  proskomma.importDocuments(selectors, 'usfm', [usfm]);
  var perfResultDocument = proskomma.gqlQuerySync('{documents {id docSetId perf} }').data.documents[0];
  var docId = perfResultDocument.id;
  var docSetId = perfResultDocument.docSetId;
  proskomma.gqlQuerySync("mutation { deleteDocument(docSetId: \"".concat(docSetId, "\", documentId: \"").concat(docId, "\") }"));
  var perf = JSON.parse(perfResultDocument.perf);
  return {
    perf
  };
};
var usfmToPerf = {
  name: "usfmToPerf",
  type: "Transform",
  description: "USFM=>PERF: Conversion via Proskomma",
  inputs: [{
    name: "usfm",
    type: "text",
    source: ""
  }, {
    name: "selectors",
    type: "json",
    source: ""
  }],
  outputs: [{
    name: "perf",
    type: "json"
  }],
  code: usfmToPerfCode
};
module.exports = {
  usfmToPerf,
  usfmToPerfCode
};